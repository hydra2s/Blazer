<!doctype html>
<head>
    <!-- meta -->
    <meta charset="utf-8" http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <meta name="HandheldFriendly" content="true" />

    <title>RGBA format testing</title>
    <!--<script src="pako/pako_deflate.js"></script>-->
    <!--<script src="UPNG.js"></script>-->

    <script src="pinch-zoom-mod.js"></script>
    <script async src="deps/crc32.js"></script>
    <script async type="module" src="./blazer.js"></script>

    <!-- Sanitize V2, CSS library -->
    <link href="sanitize-2/sanitize-2.css" rel="stylesheet">
    <link href="blazer.css" rel="stylesheet">
    
    <!-- Development version -->
    <script async src="https://unpkg.com/lucide@latest/dist/umd/lucide.js" crossorigin="anonymous"></script>

    <!--<script async type="module">
        import {  OverlayScrollbars } from './overlayscrollbars/overlayscrollbars.esm.js';
        OverlayScrollbars(document.querySelector('body'), { overflow: { x: 'hidden' } });
    </script>-->
</head>
<body><scroll-able storage="body">

    <script type="module" async>
        import {loadImage, getSharedImageData, InterWork, provideForWorker, IDBCache, BlazerRGBA} from "./blazer.js";

        //const WC = new InterWork(provideForWorker(new Worker("./blazer.js", {type: "module"})), true);
        //const {BlazerRGBA} = await WC.proxy("default");
        
        /*const db = await new IDBCache().open("openjng", {
            upgrade(db) {
                const store = db.createObjectStore(location.hostname, {
                    keyPath: 'id',
                    autoIncrement: true,
                });
            }
        });*/
        //indexedDB.deleteDatabase("openjng");

        var rgba = await new BlazerRGBA();
        var canvas = document.createElement("canvas");
        var bitmap = await rgba.loadImageBitmap("./img/sample.rgba");
        canvas.width = bitmap.width;
        canvas.height = bitmap.height;
        canvas.getContext("bitmaprenderer").transferFromImageBitmap(bitmap);
        document.body.appendChild(canvas);
    </script>
</scroll-able></body>
</html>
